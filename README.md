# 使用说明书

本应用是一个图形界面工具，用于对项目目录中的文本进行提取生成 CSV，并从 CSV 生成对应的 C 源文件。界面已简化为三种使用模式和一个统一的“生成”按钮，支持拖拽文件夹与 CSV 自动执行。

## 环境要求
- 操作系统：Windows（兼容 Windows 7 及以上）
- Python：建议 `3.8` 或更高版本
- 依赖：`PyQt5`（若未安装，可通过 `pip install PyQt5` 安装）

## 安装与启动
- 进入项目目录：`e:\code\cpeject\test_mooc-clin`
- 启动命令：`python gui_app\main.py`
- 启动后出现窗口，即可填写路径或拖拽操作使用；偶尔出现 `libpng warning: iCCP` 警告，可忽略。

## 界面总览
- `项目目录`：选择或输入你的工程路径，作为根目录与默认输出位置
- `CSV输入`：从 CSV 生成 C 时的输入文件（可留空，由项目目录推断）
- `CSV输出`：提取时生成的 CSV 文件路径（可留空，自动填充）
- `C输出`：从 CSV 生成的 C 源文件路径（可留空，自动填充）
- `使用模式`：下拉选择三种模式（默认“提取并生成”）
  - `仅提取CSV`：从项目目录提取文本到 CSV
  - `仅生成C`：从 CSV 生成 C 源文件
  - `提取并生成`：先提取 CSV，再生成 C
- `生成`：统一执行入口，按当前选择的使用模式运行
- 日志区域：实时显示执行的步骤、命令与结果，便于排查

## 快速开始
1. 填写或选择 `项目目录`
2. 保持 `使用模式` 为 `提取并生成`（默认）
3. 直接点击 `生成`
4. 程序会自动：
   - 若 `CSV输出` 为空，使用 `项目目录/ty_text_out.csv`
   - 若 `C输出` 为空，使用 `项目目录/generated_text_vars_preserved.c`
   - 完成提取后自动继续生成 C

## 使用模式详解
### 仅提取CSV
- 必填：`项目目录`
- 输出：`CSV输出` 未填时默认 `项目目录/ty_text_out.csv`

### 仅生成C
- 优先使用 `CSV输入`；若未填且 `项目目录` 已设置，则默认从 `项目目录/ty_text_out.csv` 读取
- 输出：`C输出` 未填时默认 `项目目录/generated_text_vars_preserved.c`

### 提取并生成
- 使用 `项目目录` 作为根目录；如果输出未填写，自动按默认规则填充
- 先执行提取，再自动执行生成

## 拖拽操作
### 拖拽“项目文件夹”到窗口
- 自动将其设为 `项目目录`
- 自动填充默认 `CSV输出` 与 `C输出`
- 自动执行 `提取并生成`

### 拖拽“CSV文件”到窗口
- 自动将其设为 `CSV输入`
- 若未设 `项目目录`，使用该 CSV 的父目录作为项目目录
- 自动执行 `仅生成C`

## 默认路径与命名规则
- `CSV输出` 默认：`项目目录\ty_text_out.csv`
- `C输出` 默认：`项目目录\generated_text_vars_preserved.c`
- 你可在界面中手动修改输出文件名或路径（例如改为 `项目目录\text_out.csv` 或输出到 `项目目录\src\generated\...`）

## 日志与状态
- 日志窗口会显示每个步骤的执行命令、参数与结果
- 成功或失败都会有明确记录；若失败，日志会给出错误提示（路径不存在、权限不足、文件被占用等）

## 常见问题
- 路径包含空格或中文：支持中文路径；含空格路径自动按引号处理，但建议使用标准盘符路径
- 没有权限或文件被占用：以管理员权限运行，或将输出路径改至用户可写目录；关闭占用文件的程序
- 没有安装 `PyQt5`：`pip install PyQt5`；若网络环境受限，可使用国内源或离线安装包
- 启动出现 `libpng warning: iCCP...`：该警告不影响功能，可忽略
- 提取后未生成 C：确认 `使用模式` 是否选择了 `提取并生成`；或点击一次“生成”后查看日志是否有错误

## 使用建议
- 只需填写 `项目目录`，其它输入框可留空，系统会按默认规则自动填充与执行
- 若你已有标准的 CSV，如 `项目目录\ty_text_out.csv`，在 `仅生成C` 模式下可以只填 `项目目录` 并点击“生成`
- 自定义文件名或目录请在生成前填写对应输入框

## 个性化与扩展
- 我可以为你定制文件命名规则（例如 `text_out.csv`、`src\generated\text_vars.c`）
- 可选增加批量拖拽多个 CSV 的处理、或对 `.c` 文件进行反向校验等高级功能