# DirModeEx - C++/Qt Windows 7 兼容版

本项目为基于 Qt Widgets 的目录/文件管理示例，实现与原软件一致的常见目录操作与用户交互逻辑：路径导航、目录树、文件表、刷新、新建、重命名、删除、复制、移动等。

## 开发环境

- Qt `5.15.x`（或你指定的 `${qt_version}`，需兼容 Windows 7）
- C++ `${cpp_standard}`（推荐 `C++17`）
- 编译器：MSVC v141（VS2017/2019）或 MinGW 7.x，Windows 7 SP1 兼容 SDK

## 构建

### 使用 qmake

1. 打开 `DirModeEx/DirModeEx.pro`
2. 选择 Qt 5.15.x 对应的 Kit（确保 Win7 兼容）
3. 构建并运行（Release）

### 使用 CMake

```powershell
cd packaging
.\build_dir_mode_ex_win7.ps1 -QtBin "C:\Qt\5.15.10\msvc2017_64\bin" -Generator "Visual Studio 16 2019" -Arch x64
```

脚本将生成 `DirModeEx.exe` 并使用 `windeployqt` 复制依赖到 `build\DirModeEx\release_pack`。

## 运行与部署

- 将 `release_pack` 目录整体复制到 Windows 7 SP1 机器上，双击 `DirModeEx.exe` 即可运行。
- 如需单文件安装包，可使用 NSIS 或 Inno Setup；此项目不包含安装器配置。

## 功能说明

- 目录树：左侧 `QTreeView` 展示目录结构；右侧 `QTableView` 展示当前目录文件/子目录。
- 路径栏：输入路径并回车跳转（示例：`C:/Users`）。
- 工具栏操作：
  - 刷新：重新加载当前目录
  - 新建文件夹：在当前目录创建子目录
  - 重命名：选中单项后重命名
  - 删除：支持多选；目录递归删除（慎用）
  - 复制到：复制选中项到指定目录（目录复制仅创建空同名目录）
  - 移动到：移动选中项到指定目录
- 双击：双击目录进入；双击文件仅日志记录（可扩展为打开/预览）。

## 质量保证

- 内存管理：所有视图与模型使用 Qt 父子关系自动释放；日志文件在退出时关闭。
- 错误处理：用户输入无效路径、文件操作失败、依赖缺失等均弹窗提示；日志写入 `logs/dir_app.log`。
- 功能测试建议：
  - 在不同目录下执行新建/重命名/删除/复制/移动
  - 测试中文/空格/特殊字符文件名
  - 大量文件目录的刷新/选择操作
  - 非管理员权限下的操作错误提示

## 与原软件交互逻辑的一致性

- 路径导航与目录/文件列表分屏展示
- 工具栏提供常用操作按钮与状态提示（状态栏）
- 双击进入/选中行进行操作，保持直觉式桌面交互逻辑

## 注意事项（Win7）

- 使用 Qt 5.12–5.15 的套件；Qt 6 不支持 Windows 7。
- 如果运行缺少 Qt 依赖，请在构建后使用 `windeployqt` 收集依赖。
- 跨盘符/权限受限的目录可能操作失败，注意错误提示与日志。